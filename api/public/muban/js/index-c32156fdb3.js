!function(t){function e(a){if(n[a])return n[a].exports;var o=n[a]={exports:{},id:a,loaded:!1};return t[a].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){t.exports=n(5)},,function(t,e,n){function a(t){var e,n=[],a=encodeURIComponent;for(e in t)n.push(a(String(e))+"="+a(String(t[e])));return n.join("&")}function o(t){var e=t||location.search.substr(1),n={};return e.split("&").forEach(function(t){var e=t.split("=");n[e[0]]=decodeURIComponent(e[1])}),n}function i(t,e){var e=e||window.location.href.split("#")[0],n="object"==typeof t?a(t):t;return e+=(e.split("?")[1]?"&":"?")+n}function r(){for(var t,e,n,a=!1,o=["webkit","Moz","O",""],i=o.length,r=document.documentElement.style;i--;)if(o[i]){if(void 0!==r[o[i]+"AnimationName"]){switch(t=o[i],i){case 0:e=t.toLowerCase()+"AnimationStart",n=t.toLowerCase()+"AnimationEnd",a=!0;break;case 1:e="animationstart",n="animationend",a=!0;break;case 2:e=t.toLowerCase()+"animationstart",n=t.toLowerCase()+"animationend",a=!0}break}}else if(void 0!==r.animationName){t=o[i],e="animationstart",n="animationend",a=!0;break}return{supported:a,prefix:t,start:e,end:n}}function s(t,e,n,a){g.removeClass("msg-on");var o=$("#msg-cnt");o.length||($('<div id="msg-cnt" class="msg-cnt"></div>').appendTo(g),o=$("#msg-cnt")),e?o.attr("class","msg-cnt msg-type-"+e):o.attr("class","msg-cnt"),o.html("<span>"+t+"</span>").off("animationend"),g.addClass("msg-on");var n=n,i=a?1e3*a:1e3;window.setTimeout(function(){g.removeClass("msg-on"),n&&n()},i)}function c(t){window.location=m+"?dest="+encodeURIComponent(t||location.href)}function l(){return window.channelID&&/^\d+$/.test(channelID)?channelID:(window.channelID=h.cookie.get("mzl_channel")||"",channelID)}function d(){if(!window._hmt){var t=v["default"],e="";e=window.channelID?channelID:h.cookie.get("mzl_channel"),e&&v[e]&&(t=v[e]);var n=n||[];!function(){var e=document.createElement("script");e.src="//hm.baidu.com/hm.js?"+t;var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)}(),window._hmt=n}}function u(){var t=$("#app-link,.app-link");if(t.length){var e=h.getChn(),n=e.match("1600"),a=window.location.href.match("/index/app/channel/"),o="http://a.app.qq.com/o/simple.jsp?pkgname=com.zhulang.reader",i="https://app2.zhulang.com/app/download/",r="https://itunes.apple.com/us/app/id1128277830?l=zh&ls=1&mt=8";if(h.isMobile.Android()&&(t.data("android")&&t.attr("href",t.data("android")),t.data("apk")&&t.attr("href",t.data("apk")),n)){var c=t.attr("href");c.match("https")||(i+=c.split("/app/")[1],t.attr("href",i)),$(".app-bar").click(function(){var t=$(this).find(".app-link").attr("href");window.location=t})}h.isMobile.iOS()&&(t.data("ios")&&t.attr("href",t.data("ios")),n&&t.attr("href",r)),(h.isMobile.Weixin()||h.isMobile.QQ())&&!a&&(t.attr("href",o),$(".n-app").attr("href",o)),h.isMobile.Weibo()&&t.on("click",function(t){s("请在浏览器中打开下载",null,null,3)})}}function f(){var t=$(".verifyimg");t.length&&t.click()}var h={showMsg:s,goLogin:c,supportAnimate:r,supportTouch:"ontouchstart"in document.documentElement,io:{},regs:{},ui:{},chn:""},g=$("body"),m="//m.zhulang.com/login/index.html";h.getChn=function(){return h.chn?h.chn:(h.chn=h.cookie.get("mzl_channel")||"default",h.chn)},h.isMobile={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},Weixin:function(){return navigator.userAgent.match(/MicroMessenger/i)},QQ:function(){return navigator.userAgent.match(/QQ/)},Weibo:function(){return navigator.userAgent.match(/weibo/i)},any:function(){return isMobile.Android()||isMobile.BlackBerry()||isMobile.iOS()||isMobile.Opera()||isMobile.Windows()}},h.regs={mobi:/^(?:13|14|15|16|17|18|19)[\d]{9}$/,username:/^[a-zA-Z0-9][\w-]{2,30}$/,bankcard:/^[0-9](?:[\d]{21}|[\d]{20}|[\d]{19}|[\d]{18}|[\d]{17}|[\d]{16}|[\d]{15}|[\d]{14}|[\d]{13}|[\d]{12}|[\d]{11}|)$/,email:/^[A-Z0-9._%-]+@[A-Z0-9.-]+\.[A-Z]{2,6}$/},h.ui.cur=function(t,e,n){var t=$(t)||t,a=e||"cur";t.addClass(a).siblings().removeClass(a)},h.ui.ena=function(t){var e="disabled";t&&t.each(function(t){$(this).removeClass(e).removeAttr(e)})},h.ui.dis=function(t){var e="disabled";t&&t.each(function(t){$(this).attr(e,e).addClass(e)})},h.ui.loadimg=function(t,e){var t=$(t),n="imgLoadFlag";if(!t.data(n)){var a=t.find("img[data-src],img[data-bg]");a.length&&(a.each(function(){var t=$(this),e=t.data("src"),n=t.data("bg");e&&t.attr("src",e).removeAttr("data-src"),n&&t.css({"background-image":"url("+n+")"}).removeAttr("data-bg")}),t.data(n,1))}},h.ui.tab=function(t,e,n,a,o){var o=o||"click",i=$(t).find(e),r=$(n).find(a);i.on(o,function(t){var e=$(this),n=e.index(),o=r.eq(n),i=h.ui.cur;i(this,"cur"),o.show().siblings(a).hide(),e.blur(),h.ui.loadimg(o),t.preventDefault()})},h.io.serialize=a,h.io.parseUrl=o,h.io.addUrlParam=i,h.io.xssEscape=function(t){return t=String(null===t?"":t),t.replace(/&(?!\w+;)|["'<>\\]/g,function(t){switch(t){case"&":return"&amp;";case"\\":return"\\\\";case'"':return"&quot;";case"'":return"&#39;";case"<":return"&lt;";case">":return"&gt;";default:return t}})},h.io.parseJson=function(t){try{if("object"==typeof t)return t;if("string"==typeof t)return JSON.parse(t)}catch(e){console.log("parseJson error \n org-data: \n "+t)}};r();!function(t){function e(){var t={};if(document.cookie){var e=document.cookie.split("; ");e.forEach(function(e,n,a){var o=e.split("="),i=o[0],r=o[1];t[i]=r})}return t}function n(t,e,n){if(t&&e){var a=encodeURIComponent(t)+"="+encodeURIComponent(e);return n&&(n.maxAge&&(a+="; max-age="+n.maxAge),n.path&&(a+="; path="+n.path),n.domain&&(a+="; domain="+n.domain),n.secure&&(a+="; secure")),document.cookie=a,a}return""}function a(t){return decodeURIComponent(e()[t])||null}function o(t){e()[t]&&(document.cookie=t+"=; max-age=0")}function i(){var t=e();for(var n in t)document.cookie=n+"=; max-age=0"}function r(t){return e()}function s(t){return t&&"string"==typeof t?t&&window.cookie?(window[t]=window.cookie,delete window.cookie,window[t]):void 0:window.cookie}t.cookie={getCookies:r,set:n,get:a,remove:o,clear:i,noConflict:s}}(h);var v={"default":"e5883283abd0285c634898e065e21499",200001:"93083ac76898fe363cd44a3b9c599716",200002:"59e10cf75029fe5d23a3c5b4068f18f9",160020:"59ebf7a83435c374ab6f94e9c1f58f5a",160021:"660c43db3a131fffa13832636259b95e",160023:"3fd1ba328e6b479dda5668344189cfe9",160024:"0d758ee64750c01ad7728fd460c30f0d",170120:"40b7afcd3a044cefe0cc8eb54b95f6a2"};$(function(){l(),$(".backicon").on("click",function(){window.history.go(-1)}),$(".verifyimg").on("click",function(){var t=$(this),e=t.attr("src").split("?");t.attr("src",e[0]+"?__t="+ +new Date)});var t=window.weixinShareImg||"https://s.zhulang.com/images/zl320v1.png";(h.isMobile.Weixin()||h.isMobile.QQ())&&(g.addClass("inwx"),g.prepend('<div id="zl-wx-share-img" style=" overflow:hidden; width:0px; height:0; margin:0 auto; position:absolute; top:-800px;"><img src="'+t+'"></div>')),$(".js-login,.js-log").on("click",function(){c()}),u(),d()}),h.io.refreshChar=f,t.exports=h},,,function(t,e,n){function a(){var t=$("#home-sch");if(t.length){var e=t.find("input.kw"),n="fcs";e.on("input focus",function(){e.val().length?t.addClass(n):t.removeClass(n)}),t.find(".icon-reset").on("click",function(){e.val(""),t.removeClass(n)})}}function o(){var t=navigator.userAgent.match(/MicroMessenger/i);t&&$("#app-link").on("click",function(){var t=$(this).attr("href");t.match(/apk|itunes/i)&&i.showMsg("请点击右上角并用浏览器打开")})}var i=n(6);$(function(){i.tab("#new-tab","a","#new-con","div"),a(),o(),console.log("document ready")})},function(t,e,n){var a=n(2),o=n(7),i="log_dest",r=document,s=s||{},c=a.ui.loadimg,l=window.userInfo&&userInfo.uid;s.tab=a.ui.tab,s.showMsg=a.showMsg,s.goLogin=a.goLogin;var d=[];s.swipeInit=function(){$(".swiper-container").length&&$(".swiper-container").each(function(t){var e=$(this),n=e.find(".swiper-pagination"),a=e.data("loop"),o=e.data("auto"),i={pagination:n.get(0),slidesPerView:1,spaceBetween:0,loop:a,onInit:function(t){var e=t.slides[0];c(e)},onSlideNextStart:function(t){var e=t.slides[t.activeIndex];c(e)}};1*o&&(i.autoplay=1e3*o),d[t]=new Swiper(e.get(0),i)})},s.altSwitch=function(){var t=$(".altbox");if(t.length){var e=t.find("li"),n=e.length;if(!(2>n)){var a=null,o=5,i=0;a=setInterval(function(){i++,i>=n&&(i=0),e.hide(),e.eq(i).show()},1e3*o)}}},s.saleCountDown=function(){var t=$("[data-lft]");if(t.length){var e=[],n=60,a=n*n,o=24*a;t.each(function(t){function i(t){if(t=Math.max(0,t),0==t)return void r.addClass("disabled").html("已经结束");a>=s&&(l=1);var e=Math.floor(t/o),i=c;e&&(i+=e+"天");var d=Math.floor(t%o/a);d&&(i+=d+"小时");var u=Math.floor(t%a/n);if(10>u&&(u="0"+u),i+=u+"分",60>l){var f=Math.floor(t%n);10>f&&(f="0"+f),i+=f+"秒"}r.html(i)}var r=$(this),s=r.data("lft");if(s){var c=r.data("pre")||"",l=60;a>=s&&(l=1),i(s),e[t]=setInterval(function(){s-=l,i(s),a>=s&&(clearInterval(e[t]),e[t]=setInterval(function(){s-=l,i(s),0>s&&clearInterval(e[t])},1e3)),0>s&&clearInterval(e[t])},1e3*l)}})}},s.refreshContentCtl=function(){$("[data-refresh]").on("click",function(){var t=$(this),e=t.data("loading");if(!e){var n=t.data("api");if(!n)return void console.log("no url for fetch data");var o=$(t.data("refresh"));t.data("tmp");if(!o.length)return void console.log("no element to refresh");t.data("loading",!0),o.addClass("refreshing");var i=t.data("param")||"";$.ajax({type:"GET",dataType:"json",url:n,data:i,success:function(t){var e=1*(t.code||t.ret);if(e)return void(t&&t.msg&&a.showMsg(t.msg));var n=t.html;n.length&&$(o).html(n)},error:function(t){a.showMsg("网速不给力,稍后重试~~")},complete:function(){o.removeClass("refreshing"),t.data("loading",!1)}})}})},Array.prototype.getUnique=function(){for(var t={},e=[],n=0,a=this.length;a>n;++n)t.hasOwnProperty(this[n])||(e.push(this[n]),t[this[n]]=1);return e},s.delFromShelfCtl=function(){$(r).on("click","[data-act=del-from-shelf]",function(){var t=$(this),e=t.data("api"),n=t.data("post");return e?void(t.hasClass("sending")||(t.addClass("sending"),$.ajax({type:"POST",url:e,data:n,success:function(t){"string"==typeof t&&(t=JSON.parse(t));var e=1*t.code;if(e){var n=t.msg||"删除失败，请稍后重试~";return void a.showMsg(n)}var o=t.bookid,i=$("#shelf-"+o);i.length&&i.remove();var r=$("#shelf-count");r.length&&r.text(Math.max(0,1*r.text()-1)),a.showMsg(t.msg||"删除成功")},error:function(t){a.showMsg("删除失败，请稍后重试~")},complete:function(){t.removeClass("sending")}}))):console.log("need api url")})},s.addToShelfCtl=function(){$(r).on("click","[data-act=add-to-shelf]",function(){var t=$(this);if(!l){var e=t.data("bid");return o.set("last-act","add-"+e),void setTimeout(function(){a.goLogin()},100)}if(!t.hasClass("sending")){var n=t.data("api"),i=t.data("post");if(!n)return console.log("need api url");t.data("orgtxt",t.text()).text("添加中").addClass("sending"),$.ajax({type:"POST",url:n,data:i,success:function(e){"string"==typeof e&&(e=JSON.parse(e));var n=1*e.code;if(n){var o=e.msg||"添加失败，请稍后重试~";return void a.showMsg(o)}a.showMsg(e.msg||"添加到书架成功!");var i=1*e.bookid;if(i){var r=$(".add-"+i);r.length&&r.removeAttr("data-act").text("已收藏")}else t.removeAttr("data-act").text("已收藏")},error:function(e){a.showMsg("添加失败，请稍后重试~"),t.text(t.data("orgtxt"))},complete:function(){t.removeClass("sending");var e=o.get("last-act");e&&o.rm("last-act")}})}})},s.autoAddAfterLogin=function(){var t=document.referrer,e=o.get("last-act");if(t.match("m.zhulang.com/login")&&/add-\d+/.test(e)){var n=$("."+e);n.length&&n.trigger("click")}},s.getBookIdFromDom=function(t){var e=$(t),n=1*e.data("bid");if(!n){var a=e.closest("[data-bid]");n=a.data("bid")}return n||(n=window.bookInfo&&bookInfo.bookid),n||0},s.readHistory=function(){function t(t){var t=t||window.bookInfo&&bookInfo.bid;return t?o.get(c+t):null}function e(){var t=localStorage,e={bid:0,time:0};for(var n in t)if(n.match(c)){var a=o.get(n);a.time=a.time||1,a.time>e.time&&(e=a)}return e}function n(){var e=(localStorage,$("[data-history]"));e.each(function(){var e=$(this),n=s.getBookIdFromDom(e);if(n){var a=t(n);a&&i(a,e)}})}function a(){var t=$("#read-last");if(t.length){var n=e();if(n.bid){t.find("i").text("继续");var a=n.url.split("#")[0];a+="#zrpos="+n.pos,t.find("a").attr("href",a),t.find("span").text(n.chname)}}}function i(t,e){var n=t.url.split("#")[0];n+="#zrpos="+t.pos,t.newUrl=n;var a=e.data("history"),o=e.hasClass("btn");a.match("url")&&e.attr("href",n),a.match("chname")&&e.text("已读:"+t.chname),o&&e.text("继续阅读"),e.removeAttr("data-history")}var r={},c="zreadPos_";return r.getReadProgress=t,r.init=function(){a(),n()},r}(),s.selLinkCtl=function(){$("select[data-link]").on("change",function(){var t=$(this),e=t.val(),n=t.data("link"),a=n.replace("#val#",e);window.location=a})},s.subscribeCtl=function(){function t(t){o=!0,t.addClass("sending").data("orgtxt",t.text()).text(i)}function e(t){t.removeClass("sending").text(t.data("orgtxt"))}var n=[".btn-order",".btn-order-all"],o=!1,i="正在订阅";$(r).on("click",n.join(","),function(){var n=$(this),i=n.data("api"),r=n.data("post")||"";n.hasClass("sending")||n.hasClass("ordered")||(t(n),$.ajax({url:i,type:"POST",data:r,timeout:1e4,success:function(t){"string"==typeof t&&(t=JSON.parse(t));var o=1*t.code;if(o){var i=t.msg||"订阅失败，请稍后重试~";return a.showMsg(i),void e(n)}var i=t.msg||"订阅成功，正在为您跳转";n.addClass("ordered").text("订阅成功!");var r=t.url||document.referrer;a.showMsg(i,null,function(){window.location=r})},error:function(t){a.showMsg("订阅失败，请稍后重试"),e(n)},complete:function(){n.removeClass("sending"),o=!1}}))})},s.flowerDisTips=function(){$(r).on("click",".flw-dis",function(t){t.preventDefault();var e=$("this"),n=e.data("msg")||"作品未上架，暂时不能送花";s.showMsg(n)})},s.autoTab=function(){$('[data-role="tab"]').each(function(){var t=$(this),e=t.data("tag"),n=t.data("con"),a=$(n).data("tag"),o=t.data("act")||"click";s.tab(t,e,n,a,o),t.find(".cur").trigger(o)})},s.randomLazyBg=function(){var t=5;$("[data-src]").each(function(){var e=$(this),n=Math.floor(Math.random()*t);e.addClass("lz-bgc-"+n)})},s.needLoginCtl=function(){l||$(".nd-log").on("click",function(t){t.preventDefault();var e=$(this).attr("href");a.goLogin(e)})},s.chnClsCtl=function(){var t=a.cookie,e="mzl_channel",n=t.get(e);n&&$("body").addClass("chn-"+n)},s.backTopBtnCtl=function(){var t=$("#back-top-btn");if(t.length){var e=$(window).height(),n=$("body"),a="need-roll";$(window).on("scroll",function(){var t=document.body.scrollTop;t>1.1*e?n.addClass(a):n.removeClass(a)})}},s.refreshSectionCtl=function(){$("div.refresh-bar").on("click",function(){var t=$(this),e=t.data("loading"),n=t.find("span"),o="fetching",i="refreshing";if(!e){var r=t.data("api");if(!r)return void console.log("no url for fetch data");var s=t.siblings("ul");if(!s.length)return void console.log("no element to refresh");t.data("loading",!0),s.addClass(i),n.addClass(o),$.ajax({type:"GET",dataType:"json",url:r,data:{__t:1*new Date},success:function(t){var e=1*(t.code||t.ret);if(e)return void(t&&t.msg&&a.showMsg(t.msg));var n=t.html;n.length&&s.html(n)},error:function(t){a.showMsg("网速不给力,稍后重试~~")},complete:function(){s.removeClass(i),n.removeClass(o),t.data("loading",!1)}})}})},s.homeTopSchCtl=function(){var t=$("#home-sch");t.length&&t.find(".icon-sch").on("click",function(){t.submit()})},s.authRedirect=function(){var t=window.location.href.split("?")[0];if(t.match("/user/index/index/auth/")){var e=o.get(i);e&&(a.showMsg("即将转向登陆前页面"),o.rm(i),setTimeout(function(){window.location=decodeURIComponent(e)},2e3))}},$(function(){s.homeTopSchCtl(),s.needLoginCtl(),s.refreshSectionCtl(),PicLazyUtil.init(300),s.chnClsCtl(),s.swipeInit(),s.altSwitch(),s.autoTab(),s.saleCountDown(),s.refreshContentCtl(),s.delFromShelfCtl(),s.addToShelfCtl(),s.selLinkCtl(),s.readHistory.init(),s.subscribeCtl(),s.flowerDisTips(),s.authRedirect(),setTimeout(function(){s.autoAddAfterLogin()},100),setTimeout(function(){s.randomLazyBg(),s.backTopBtnCtl()},500),setTimeout(function(){var t=lib.flexible.dpr;if(1===t){var e=$(".cor-r");e.length&&$("body").addClass("show-cor")}},1e3)}),function(e){t.exports=e}(s)},function(t,e,n){!function(n,a){"undefined"!=typeof t&&t.exports&&(e=t.exports=a(n,e))}(this,function(t,e){"use strict";return Array.prototype.indexOf||(Array.prototype.indexOf=function(t){var e=this.length>>>0,n=Number(arguments[1])||0;for(n=0>n?Math.ceil(n):Math.floor(n),0>n&&(n+=e);e>n;n++)if(n in this&&this[n]===t)return n;return-1}),e.prefix="",e._getPrefixedKey=function(t,e){return e=e||{},e.noPrefix?t:this.prefix+t},e.set=function(t,e,n){var a=this._getPrefixedKey(t,n);try{localStorage.setItem(a,JSON.stringify({data:e}))}catch(o){console&&console.warn("Lockr didn't successfully save the '{"+t+": "+e+"}' pair, because the localStorage is full.")}},e.get=function(t,e,n){var a,o=this._getPrefixedKey(t,n);try{a=JSON.parse(localStorage.getItem(o))}catch(i){a=localStorage[o]?{data:localStorage.getItem(o)}:null}return null===a?e:"object"==typeof a&&"undefined"!=typeof a.data?a.data:e},e.sadd=function(t,n,a){var o,i=this._getPrefixedKey(t,a),r=e.smembers(t);if(r.indexOf(n)>-1)return null;try{r.push(n),o=JSON.stringify({data:r}),localStorage.setItem(i,o)}catch(s){console.log(s),console&&console.warn("Lockr didn't successfully add the "+n+" to "+t+" set, because the localStorage is full.")}},e.smembers=function(t,e){var n,a=this._getPrefixedKey(t,e);try{n=JSON.parse(localStorage.getItem(a))}catch(o){n=null}return null===n?[]:n.data||[]},e.sismember=function(t,n,a){this._getPrefixedKey(t,a);return e.smembers(t).indexOf(n)>-1},e.getAll=function(){var t=Object.keys(localStorage);return t=t.filter(function(t){return-1!==t.indexOf(e.prefix)}),t.map(function(t){return e.get(t.substr(e.prefix.length))})},e.srem=function(t,n,a){var o,i,r=this._getPrefixedKey(t,a),s=e.smembers(t,n);i=s.indexOf(n),i>-1&&s.splice(i,1),o=JSON.stringify({data:s});try{localStorage.setItem(r,o)}catch(c){console&&console.warn("Lockr couldn't remove the "+n+" from the set "+t)}},e.rm=function(t){localStorage.removeItem(t)},e.flush=function(){localStorage.clear()},e})}]);